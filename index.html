<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Jesus Loves You</title>
  <!-- Also place inside <head> -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='12' fill='%230b2c5a'/><path d='M30 10h4v16h16v4H34v24h-4V30H14v-4h16z' fill='%23fff'/></svg>">
  <meta name="description" content="Pointing people to Jesus with daily Bible verses and quick links to six Bible versions." />
  <meta name="theme-color" content="#002244" />

  <!-- Open Graph / Twitter -->
  <meta property="og:title" content="Jesus is the Way" />
  <meta property="og:description" content="A daily dose of your Bible verse in both Tagalog and English." />
  <meta property="og:type" content="website" />
  <meta property="twitter:card" content="summary_large_image" />

  <!-- Canonical (SEO) -->
  <link rel="canonical" href="." />

  <!-- Performance preconnects -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

  <!-- JSON-LD (SEO) -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"WebSite",
    "name":"Jesus Loves You",
    "url":".",
    "potentialAction":{
      "@type":"SearchAction",
      "target": ".?q={search_term_string}",
      "query-input":"required name=search_term_string"
    }
  }
  </script>

  <style>
    /* ================== THEME VARS ================== */
    :root{
      --brand-deep:#001f3f;
      --brand-mid:#003366;
      --brand-accent:#0ea5e9;
      --brand-gold:#f5c542;
      --ink:#1f2937;
      --muted:#6b7280;
      --paper:#f9fafb;
      --card:#ffffff;
      --ring: rgba(14,165,233,.35);
      --shadow: 0 10px 30px rgba(0,0,0,.08);
      --radius: 14px;
      --danger:#ef4444;
    }
    @media (prefers-color-scheme: dark){
      :root{
        --ink:#ffffff;
        --muted:#cbd5e1;
        --paper:#0b1220;
        --card:#0f172a;
        --brand-deep:#031a33;
        --brand-mid:#052b52;
      }
    }
    html[data-theme="dark"] { color-scheme: dark; }

    /* ================== RESET & BASE ================== */
    *, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
    html{ scroll-behavior:smooth; }
    body{
      font-family:'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 700px at 10% 0%, #eaf3ff 0%, transparent 60%),
                  radial-gradient(1000px 600px at 100% 20%, #eef7ff 0%, transparent 60%),
                  var(--paper);
      color:var(--ink);
      line-height:1.6;
    }
    a{ text-decoration:none; color:inherit; }
    h1,h2,h3{ margin-bottom:.75rem; }

    /* ================== ACCESSIBILITY ================== */
    .skip-link{ position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden; }
    .skip-link:focus{
      left:1rem; top:1rem; width:auto; height:auto; padding:.5rem .75rem; z-index:1100;
      background:#fff; color:#000; border-radius:8px; box-shadow:var(--shadow);
    }
    :focus-visible{ outline:2px solid var(--ring); outline-offset:2px; border-radius:10px; }

    /* ================== HEADER / NAV ================== */
    header{
      background: linear-gradient(45deg, var(--brand-deep), var(--brand-mid));
      color:#fff; position:sticky; top:0; z-index:1000;
      box-shadow: 0 6px 16px rgba(0,0,0,.18);
    }
    .nav-container{
      max-width:1100px; margin:0 auto;
      display:flex; align-items:center; justify-content:space-between;
      padding:.70rem 1rem;
      gap:.35rem;
    }
    .logo{
      display:flex; align-items:center; gap:.6rem;
      font-size:1.15rem; font-weight:800; letter-spacing:.3px;
    }
    .logo i{ color:var(--brand-gold); }
    .menu-toggle{ display:none; border:none; background:transparent; color:#fff; font-size:1.1rem; padding:.35rem .55rem; border-radius:8px; }
    .menu-toggle:hover{ background: rgba(255,255,255,.08); }
    nav ul{ list-style:none; display:flex; gap:1rem; }
    nav a{
      display:flex; align-items:center; gap:.4rem; color:#fff; font-weight:600; letter-spacing:.2px;
      padding:.35rem .55rem; border-radius:8px; transition:all .25s ease;
    }
    nav a:hover{ color:var(--brand-gold); background: rgba(255,255,255,.06); }
    nav a[aria-current="page"]{
      color:var(--brand-gold);
      background: rgba(255,255,255,.10);
      text-decoration: underline;
      text-underline-offset: 4px;
    }

    /* ===== Desktop: compact-on-idle nav (hover/tap to expand) ===== */
    @media (min-width: 769px){
      #mainNav.compact ul{ gap:.35rem; }
      #mainNav.compact a{ padding:.35rem .5rem; border-radius:999px; }
      #mainNav.compact a .label{
        max-width:0; opacity:0; transform:translateX(-6px);
        white-space:nowrap; overflow:hidden; display:inline-block;
        transition:max-width .28s ease, opacity .22s ease, transform .22s ease, margin-left .22s ease;
      }
      #mainNav.compact ul li{ transform:translateX(-8px); transition:transform .28s ease; }
      #mainNav.compact:hover a .label,
      #mainNav.compact:focus-within a .label,
      #mainNav.compact.expanded a .label{ max-width:160px; opacity:1; transform:none; margin-left:.35rem; }
      #mainNav.compact:hover ul li,
      #mainNav.compact:focus-within ul li,
      #mainNav.compact.expanded ul li{ transform:none; }
    }

    /* ===== Mobile dropdown ===== */
    @media (max-width: 768px){
      .menu-toggle{ display:inline-flex; }
      nav{ position:relative; }
      nav ul{
        display:none; flex-direction:column; gap:.5rem;
        background: linear-gradient(45deg, var(--brand-deep), var(--brand-mid));
        position:absolute; right:0; top:110%; padding:.75rem; min-width:230px;
        border-radius:12px; box-shadow:var(--shadow);
      }
      nav.open ul{ display:flex; }
    }

    /* ================== OFFLINE BANNER ================== */
    .offline {
      position: sticky; top:0; z-index:1101;
      display:none; text-align:center; background:#3f1d1d; color:#fff;
      padding:.35rem .75rem; border-bottom:1px solid rgba(255,255,255,.15);
      font-weight:800;
    }
    .offline.show{ display:block; }

    /* ================== MAIN CONTAINERS ================== */
    .container-narrow{ max-width:1000px; margin:2rem auto; padding:0 1rem; }
    .section-title{
      text-align:center; margin-bottom:1rem;
      font-size:clamp(1.4rem, 2vw + .6rem, 2rem); color:#002244; font-weight:800; letter-spacing:.3px;
    }
    @media (prefers-color-scheme: dark){ .section-title{ color:#ffffff; } }
    .section-sub{ text-align:center; color:var(--muted); margin-bottom:1.25rem; }

    /* ================== CARDS / EFFECTS ================== */
    .card-ui{
      background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow);
      transition:transform .25s ease, box-shadow .25s ease, background .25s ease;
      position:relative; overflow:hidden;
    }
    .card-ui:hover{ transform:translateY(-4px); box-shadow:0 16px 40px rgba(2,6,23,.15); }
    .halo::after{
      content:""; position:absolute; inset:-2px;
      background: radial-gradient(150px 90px at 10% 0%, rgba(245,197,66,.14), transparent 70%),
                  radial-gradient(180px 100px at 100% 0%, rgba(14,165,233,.14), transparent 70%);
      pointer-events:none;
    }

    /* ================== NEW: TOP CALL-TO-JESUS ================== */
    .hero-callout{
      background: radial-gradient(160% 140% at 0% 0%, #0b264c 0%, #0a1b33 50%, #08152a 100%);
      color:#fff; border:1px solid rgba(255,255,255,.08); padding:1.4rem 1.2rem; text-align:center;
    }
    .hero-callout .verse-ref{ color:#9fd1ff; font-weight:800; }

    /* ================== NEW: SPOTLIGHT VERSES ================== */
    .spotlight-grid{ display:grid; gap:1rem; grid-template-columns:1fr; margin-top:1rem; }
    @media (min-width:768px){ .spotlight-grid{ grid-template-columns:repeat(2,1fr); } }
    .spot-card{
      background: radial-gradient(140% 130% at 100% 0%, #0b264c 0%, #0a1b33 50%, #08152a 100%);
      color:#fff; padding:1rem 1.1rem; border:1px solid rgba(255,255,255,.08); position:relative;
    }
    .spot-card h3{ color:#fff; font-weight:800; margin-bottom:.4rem; }

    /* ================== DAILY VERSES ================== */
    .verse-row{ display:grid; grid-template-columns:1fr; gap:1rem; margin-bottom:2rem; }
    @media (min-width: 768px){ .verse-row{ grid-template-columns:repeat(2, 1fr); } }
    .verse-card{
      padding:1.2rem; text-align:center;
      background: radial-gradient(120% 140% at 0% 0%, #0b264c 0%, #0a1b33 60%, #08152a 100%);
      color:#fff; border: 1px solid rgba(255,255,255,.08);
      position: relative;
    }
    .verse-badge{
      position:absolute; left:14px; top:14px; width:36px; height:36px; border-radius:50%;
      display:flex; align-items:center; justify-content:center; background:rgba(255,255,255,.08); color:#fff;
    }
    .verse-card h3{ font-size:1.1rem; color:#fff; margin-bottom:.4rem; font-weight:800; }
    .verse-text{ font-size:1rem; color:#fff; margin-bottom:.5rem; }
    .cite-ref{ font-weight:800; color:#9fd1ff; letter-spacing:.25px; }
    .verse-actions{ text-align:center; margin-top:.5rem; display:flex; gap:.5rem; justify-content:center; flex-wrap:wrap; }

    /* ================== BIBLE VERSION GRID ================== */
    .bible-grid{ display:grid; gap:1rem; margin-bottom:2rem; grid-template-columns:1fr; }
    @media (min-width:576px){ .bible-grid{ grid-template-columns:repeat(2, 1fr); } }
    @media (min-width:768px){ .bible-grid{ grid-template-columns:repeat(3, 1fr); } }
    .bible-card{ padding:1.2rem; text-align:center; color:#0b2c5a; border:1px solid rgba(2,6,23,.05); }
    .bible-card i{ font-size:1.9rem; margin-bottom:.6rem; background: radial-gradient(40px 40px at 50% 50%, rgba(14,165,233,.25), transparent 60%); padding:.8rem; border-radius:50%; }
    .bible-card span{ display:block; font-size:1rem; font-weight:800; margin-top:.2rem; }
    .bible-card:hover{ background:#eef6ff; }
    @media (prefers-color-scheme: dark){
      .bible-card{ color:#dbeafe; border-color:rgba(255,255,255,.06); }
      .bible-card:hover{ background:#122742; }
    }

    /* ================== CONTACT + CHURCH ================== */
    .two-up{ margin-top:1rem; }
    .two-up-grid{ display:grid; gap:1rem; grid-template-columns: 1fr; }
    @media (min-width: 992px){ .two-up-grid{ grid-template-columns: 1fr 1fr; } }
    .two-up .card-box{ padding:1.25rem 1.5rem; text-align:center; border:1px solid rgba(255,255,255,.08); }
    .two-up .card-box p{ margin-left:auto; margin-right:auto; max-width:820px; }

    /* ================== DEVOTIONAL METHODS ================== */
    .devotion-grid{ display:grid; gap:1rem; grid-template-columns:1fr; }
    @media (min-width: 992px){ .devotion-grid{ grid-template-columns: repeat(3, 1fr); } }
    .devotion-card{ background:var(--card); border:1px solid rgba(2,6,23,.08); padding:1.2rem; border-radius:var(--radius); box-shadow:var(--shadow); }
    @media (prefers-color-scheme: dark){ .devotion-card{ background:#0f172a; border-color:rgba(255,255,255,.06); } }
    .devotion-card h3{ display:flex; align-items:center; gap:.5rem; margin-bottom:.5rem; }
    .devotion-card ul{ margin-left:1rem; margin-bottom:.5rem; }
    .devotion-card .example{ font-style:italic; color:var(--muted); }
    .devotion-links{ display:flex; gap:.5rem; flex-wrap:wrap; margin-top:.5rem; justify-content:center; }

    /* ================== TIKTOK LIVE ================== */
    .tiktok-live{ display:flex; justify-content:center; margin:2rem 0 0 0; }
    .tiktok-live a{
      display:inline-flex; align-items:center; gap:.6rem;
      background: linear-gradient(135deg, #25F4EE, #1da3ff); color:#fff; padding:.85rem 1.4rem;
      border-radius:12px; font-size:1.05rem; font-weight:800; box-shadow:var(--shadow);
      transition: transform .2s ease, filter .2s ease; text-align:center;
    }
    .tiktok-live a:hover{ transform:translateY(-3px); filter:saturate(1.05); }

    /* ================== FOOTER & MISC ================== */
    #follow-latest{ text-align:center; margin:0 0 .75rem 0; font-size:1.05rem; font-weight:800; color:#0b2c5a; }
    @media (prefers-color-scheme: dark){ #follow-latest{ color:#dbeafe; } }
    footer{ background:#0b1220; color:#e5e7eb; text-align:center; padding:1rem; font-size:.95rem; margin-top:2rem; border-top:1px solid rgba(255,255,255,.06); }

    .section-divider{ max-width:1100px; margin:2.25rem auto; padding:0 1rem; }
    .section-divider hr{ border:0; height:1px; background:linear-gradient(90deg, transparent, rgba(255,255,255,.25), transparent); }

    .back-to-top{
      position:fixed; right:1rem; bottom:1rem; z-index:999; border:0; border-radius:50%; width:44px; height:44px;
      display:none; align-items:center; justify-content:center;
      background: linear-gradient(45deg, var(--brand-accent), #9ae6ff); color:#000; box-shadow:var(--shadow); cursor:pointer;
    }
    .back-to-top.show{ display:flex; }
    .back-to-top i{ font-size:1.1rem; }

    /* Buttons */
    .btn-outline-primary{ color:#ffffff; border-color:#9ae6ff; }
    .btn-outline-primary:hover{ background:#22d3ee; color:#000; border-color:#22d3ee; }

    @media (prefers-reduced-motion: reduce){ *{ transition:none !important; animation:none !important; } }

    h5 { font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; font-size: 2.2rem; color: #ffffff; text-align: center; text-shadow: 0px 0px 8px rgba(255, 255, 255, 0.7), 0px 0px 15px rgba(0, 153, 255, 0.4); letter-spacing: 1px; }

    /* ======= Tools grid ======= */
    .tools-grid{ display:grid; gap:1rem; grid-template-columns:1fr; }
    @media (min-width: 992px){ .tools-grid{ grid-template-columns: repeat(3, 1fr); } }
    .tool-card{ padding:1rem 1.2rem; }
    .timer-display{ font: 800 2rem/1.1 'Inter',sans-serif; letter-spacing:1px; }
    .timer-controls{ display:flex; gap:.5rem; justify-content:center; flex-wrap:wrap; margin-top:.5rem; }
    .timer-pills{ display:flex; gap:.4rem; flex-wrap:wrap; justify-content:center; }
    .timer-pills button{ border:1px solid rgba(255,255,255,.25); background:transparent; color:#fff; padding:.25rem .5rem; border-radius:999px; font-weight:700; }
    .timer-pills button.active{ background:#22d3ee; color:#000; border-color:#22d3ee; }
    .streak-stats{ display:flex; gap:1rem; justify-content:center; font-weight:800; }
    .streak-stats .num{ font-size:1.6rem; }

    /* Journal */
    .journal-wrap textarea{ width:100%; min-height:120px; border-radius:12px; padding:.75rem; border:1px solid rgba(255,255,255,.2); background:transparent; color:#fff; }
    .journal-actions{ display:flex; gap:.5rem; flex-wrap:wrap; justify-content:center; margin-top:.5rem; }
    .journal-list{ max-height:260px; overflow:auto; }

    /* Search box */
    .search-box{ display:flex; gap:.5rem; justify-content:center; margin:.5rem 0 0 0; }
    .search-box input{ padding:.55rem .75rem; border-radius:10px; border:1px solid rgba(2,6,23,.12); min-width: 240px; }
    .search-box button{ padding:.55rem .9rem; border-radius:10px; border:1px solid rgba(2,6,23,.12); background:#0ea5e9; color:#001; font-weight:800; }
    /* compact for Tools lookup */
    .search-box.compact input{min-width:0;width:100%;max-width:220px;padding:.45rem .6rem;}
    .search-box.compact button{padding:.45rem .6rem;}

    /* QR modal sizing */
    #qrcode { display:flex; justify-content:center; padding:1rem; }
  </style>
</head>
<body>
  <a class="skip-link" href="#landing">Skip to content</a>

  <!-- Offline banner -->
  <div id="offlineBanner" class="offline" role="status" aria-live="polite">You are offline. Some links may not work. Cached content available.</div>

  <!-- HEADER NAV -->
  <header>
    <div class="nav-container">
      <div class="logo">
        <i class="fas fa-cross" aria-hidden="true"></i>
        Jesus Loves You
      </div>

      <!-- Quick controls -->
      <div class="d-none d-md-inline-flex" style="gap:.35rem;">
        <button id="fontMinus" class="menu-toggle" aria-label="Decrease font size" title="Font size -">A‚àí</button>
        <button id="fontPlus" class="menu-toggle" aria-label="Increase font size" title="Font size +">A+</button>
        <button id="themeToggle" class="menu-toggle" aria-label="Toggle dark mode" title="Toggle theme"><i class="fa-solid fa-moon"></i></button>
        <button class="menu-toggle" id="installBtn" aria-label="Install app" title="Install app" style="display:none;"><i class="fa-solid fa-download"></i></button>
      </div>

      <button class="menu-toggle" id="menuToggle" aria-label="Toggle menu"><i class="fas fa-bars"></i></button>
      <nav id="mainNav" aria-label="Primary">
        <ul>
          <li><a href="#landing"><i class="fas fa-bible" aria-hidden="true"></i><span class="label">Home</span></a></li>
          <li><a href="#bibles"><i class="fas fa-book-bible" aria-hidden="true"></i><span class="label">Bibles</span></a></li>
          <li><a href="#devotionals"><i class="fas fa-book-open" aria-hidden="true"></i><span class="label">Devotionals</span></a></li>
          <li><a href="#tools"><i class="fas fa-tools" aria-hidden="true"></i><span class="label">Tools</span></a></li>
          <li><a href="#tiktok-live"><i class="fas fa-video" aria-hidden="true"></i><span class="label">Materials</span></a></li>
          <li><a href="#contact"><i class="fas fa-envelope" aria-hidden="true"></i><span class="label">Contact</span></a></li>
          <li><a href="#church"><i class="fas fa-church" aria-hidden="true"></i><span class="label">Church</span></a></li>
          <li><a href="#realflection"><i class="fas fa-comments" aria-hidden="true"></i><span class="label">Reflections</span></a></li>
        </ul>
      </nav>
    </div>
  </header>

  <!-- CALL-TO-JESUS -->
  <section class="container-narrow">
    <div class="card-ui halo hero-callout">
      <h5>‚ÄúYou are here for a reason.‚Äù</h5>
      <p>Deep in your heart, you long for something this world can never give. That longing is the call of Jesus - His love, His truth, His home. Today is the time to say yes to Him.</p>
      <p class="mb-0"><span class="verse-ref">‚ÄúCome to me, all you who are weary and burdened, and I will give you rest.‚Äù</span> - Matthew 11:28</p>
    </div>

    <!-- SPOTLIGHT VERSES -->
    <div class="spotlight-grid" style="margin-top:1rem;">
      <div class="spot-card card-ui">
        <h3><i class="fa-solid fa-heart"></i> For God so loved the world</h3>
        <p class="verse">For God so loved the world, that he gave his only begotten Son, that whosoever believeth in him should not perish, but have everlasting life. - John 3:16</p>
      </div>
      <div class="spot-card card-ui">
        <h3><i class="fa-solid fa-dove"></i> Jesus is the way</h3>
        <p class="verse">Jesus answered, ‚ÄúI am the way and the truth and the life. No one comes to the Father except through me.‚Äù - John 14:6</p>
      </div>
    </div>
  </section>

  <!-- DAILY VERSE -->
  <main id="landing" class="container-narrow" tabindex="-1">
    <h1 class="section-title">Daily Bible Verses</h1>
    <p class="section-sub">A daily dose of your Bible verse</p>

    <div class="card-ui halo verse-card" id="verse-esv">
      <div class="verse-badge"><i class="fas fa-quote-left" aria-hidden="true"></i></div>
      <h3>English ‚Äì ESV</h3>
      <p class="verse-text" aria-live="polite">Loading‚Ä¶</p>
      <p class="cite-ref"></p>

      <div class="verse-actions" aria-label="Verse actions">
        <button class="btn btn-outline-primary btn-sm" id="btnCopyVerse"><i class="fa-solid fa-copy"></i> Copy</button>
        <button class="btn btn-outline-primary btn-sm" id="btnShareVerse"><i class="fa-solid fa-share"></i> Share</button>
        <button class="btn btn-outline-primary btn-sm" id="btnSpeakVerse"><i class="fa-solid fa-volume-high"></i> Read Aloud</button>
        <button class="btn btn-outline-primary btn-sm" id="btnImageVerse"><i class="fa-solid fa-image"></i> Save Image</button>
        <button class="btn btn-outline-primary btn-sm" id="btnOpenVerse"><i class="fa-solid fa-up-right-from-square"></i> Open</button>
        <button class="btn btn-outline-primary btn-sm" id="btnFullVerse"><i class="fa-solid fa-expand"></i> Full Screen</button>
      </div>
      <canvas id="verseCanvas" width="1200" height="630" style="display:none;"></canvas>
    </div>
  </main>

  <div class="section-divider"><hr></div>

  <!-- BIBLE VERSION CARDS -->
  <section id="bibles" class="container-narrow">
    <h2 class="section-title">Explore the Holy Bible Versions</h2>
    <p class="section-sub">6 different Bibles.</p>

    <div class="bible-grid">
      <a href="https://www.bible.com/bible/59/GEN.1.ESV" target="_blank" class="card-ui bible-card" aria-label="Open ESV Bible">
        <i class="fas fa-book-bible" aria-hidden="true"></i><span>Holy Bible ‚Äì ESV</span>
      </a>
      <a href="https://www.bible.com/tl/bible/1/GEN.1.KJV" target="_blank" class="card-ui bible-card" aria-label="Open KJV Bible">
        <i class="fas fa-crown" aria-hidden="true"></i><span>Holy Bible ‚Äì KJV</span>
      </a>
      <a href="https://www.bible.com/bible/116/GEN.1.NLT" target="_blank" class="card-ui bible-card" aria-label="Open NLT Bible">
        <i class="fas fa-feather" aria-hidden="true"></i><span>Holy Bible ‚Äì NLT</span>
      </a>
      <a href="https://www.bible.com/bible/111/GEN.1.NIV" target="_blank" class="card-ui bible-card" aria-label="Open NIV Bible">
        <i class="fas fa-book-open" aria-hidden="true"></i><span>Holy Bible ‚Äì NIV</span>
      </a>
      <a href="https://www.bible.com/tl/bible/1264/GEN.1.ASD" target="_blank" class="card-ui bible-card" aria-label="Open Tagalog ASD Bible">
        <i class="fas fa-cross" aria-hidden="true"></i><span>Ang Biblia - ASD</span>
      </a>
      <a href="https://www.bible.com/bible/177/GEN.1.TLAB" target="_blank" class="card-ui bible-card" aria-label="Open Tagalog KJV Bible">
        <i class="fas fa-cross" aria-hidden="true"></i><span>Ang Biblia</span>
      </a>
    </div>
  </section>

  <div class="section-divider"><hr></div>

  <!-- TIKTOK LIVE MATERIALS -->
  <section id="tiktok-live" class="container-narrow">
    <h2 class="section-title">TikTok Live Material Series</h2>
    <p class="section-sub">Click below to view your PDF materials on Google Drive.</p>
    <div class="tiktok-live">
  <a
    href="https://drive.google.com/drive/folders/1u_M8Da598L7465Ro4sTPzdxuKb2t3HXV?usp=sharing"
    target="_blank" rel="noopener"
    aria-label="Open Google Drive folder for TikTok materials"
    class="btn-drive"
  >
    <i class="fa-solid fa-folder-open"></i>
    <span>View PDF Materials</span>
  </a>
</div>

  </section>

  <div class="section-divider"><hr></div>

  <!-- DEVOTIONAL METHODS -->
  <section id="devotionals" class="container-narrow">
    <h2 class="section-title">How to Do Devotionals</h2>
    <p class="section-sub">Three simple frameworks to help you meet with Jesus daily.</p>

    <div class="devotion-grid">
      <div class="devotion-card">
        <h3><i class="fa-solid fa-book-open"></i> SOAP Method</h3>
        <ul>
          <li><strong>S ‚Äì Scripture:</strong> Write down the verse(s) you are reading.</li>
          <li><strong>O ‚Äì Observation:</strong> Note what stands out‚Äîkeywords, context, who‚Äôs speaking.</li>
          <li><strong>A ‚Äì Application:</strong> How does it apply to your life today?</li>
          <li><strong>P ‚Äì Prayer:</strong> Write a personal prayer based on the lesson.</li>
        </ul>
        <p class="example">üìñ Example: Philippians 4:6‚Äì7 ‚Üí Not to worry but pray. I need to trust God with my anxieties today.</p>
        <div class="devotion-links">
          <a class="btn btn-sm btn-outline-primary" target="_blank" rel="noopener" href="https://duckduckgo.com/?q=SOAP+bible+study+method">Read more</a>
          <a class="btn btn-sm btn-outline-primary" target="_blank" rel="noopener" href="https://www.youtube.com/results?search_query=SOAP+bible+study+method">Watch videos</a>
        </div>
      </div>

      <div class="devotion-card">
        <h3><i class="fa-solid fa-hands-praying"></i> ACTS Method</h3>
        <ul>
          <li><strong>A ‚Äì Adoration:</strong> Praise God for who He is.</li>
          <li><strong>C ‚Äì Confession:</strong> Write honestly the sins/struggles you need to bring to Him.</li>
          <li><strong>T ‚Äì Thanksgiving:</strong> Note what you‚Äôre grateful for.</li>
          <li><strong>S ‚Äì Supplication:</strong> Ask God for help‚Äîfor yourself and others.</li>
        </ul>
        <p class="example">üìñ Example: ‚ÄúLord, You are my peace. Forgive my impatience. Thank You for guiding me yesterday. Please help me forgive others today.‚Äù</p>
        <div class="devotion-links">
          <a class="btn btn-sm btn-outline-primary" target="_blank" rel="noopener" href="https://duckduckgo.com/?q=ACTS+prayer+method">Read more</a>
          <a class="btn btn-sm btn-outline-primary" target="_blank" rel="noopener" href="https://www.youtube.com/results?search_query=ACTS+prayer+method">Watch videos</a>
        </div>
      </div>

      <div class="devotion-card">
        <h3><i class="fa-solid fa-highlighter"></i> HEAR Method</h3>
        <ul>
          <li><strong>H ‚Äì Highlight:</strong> Choose and highlight the key verse.</li>
          <li><strong>E ‚Äì Explain:</strong> Write what the verse means in context.</li>
          <li><strong>A ‚Äì Apply:</strong> How does it impact your daily walk?</li>
          <li><strong>R ‚Äì Respond:</strong> Write a personal response or prayer.</li>
        </ul>
        <p class="example">üìñ Example: John 15:5 ‚Üí Apart from Jesus I can do nothing. I must depend on Him in my work today.</p>
        <div class="devotion-links">
          <a class="btn btn-sm btn-outline-primary" target="_blank" rel="noopener" href="https://duckduckgo.com/?q=HEAR+bible+study+method">Read more</a>
          <a class="btn btn-sm btn-outline-primary" target="_blank" rel="noopener" href="https://www.youtube.com/results?search_query=HEAR+bible+study+method">Watch videos</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Devotional Resources -->
  <section id="devotional-resources" class="container-narrow">
    <h2 class="section-title">More Devotional Resources</h2>
    <p class="section-sub">As you seek his kingdom, he provides everything for your path remember, Matthew 6:33</p>
    <div class="tiktok-live" style="gap:.75rem; flex-wrap:wrap;">
      <a href="https://www.bible.com/reading-plans" target="_blank" rel="noopener" aria-label="Explore Bible reading plans"><i class="fas fa-list-check"></i> Bible Plans</a>
      <a href="https://open.spotify.com/search/worship%20songs%20playlist" target="_blank" rel="noopener" aria-label="Check Spotify worship songs playlists"><i class="fas fa-music"></i> Worship Songs</a>
    </div>
    <p class="section-sub" style="text-align:center; margin-top:.75rem;">Bible Plans - search a website that showcases Bible plans. &nbsp;|&nbsp; Worship Songs - Check Spotify for free worship songs</p>
  </section>

  <div class="section-divider"><hr></div>

  <!-- TOOLS -->
  <section id="tools" class="container-narrow">
    <h2 class="section-title">Tools to Help Your Walk</h2>
    <p class="section-sub">Timers, streaks, reminders, verse lookup‚Äîand more.</p>

    <div class="tools-grid">
      <!-- Timer -->
      <div class="card-ui halo tool-card" id="timerCard" style="color:#fff; background: radial-gradient(120% 140% at 0% 0%, #0b264c 0%, #0a1b33 60%, #08152a 100%); border:1px solid rgba(255,255,255,.08);">
        <h3 class="mb-1" style="color:#fff;"><i class="fa-solid fa-hourglass-half"></i> Devotional Timer</h3>
        <div class="timer-pills" aria-label="Quick durations">
          <button data-min="5">5m</button>
          <button data-min="10">10m</button>
          <button data-min="15" class="active">15m</button>
          <button data-min="20">20m</button>
          <button data-min="30">30m</button>
        </div>
        <div class="timer-display my-2" id="timerDisplay" aria-live="polite">15:00</div>
        <div class="timer-controls">
          <button class="btn btn-outline-primary btn-sm" id="timerStart"><i class="fa-solid fa-play"></i> Start</button>
          <button class="btn btn-outline-primary btn-sm" id="timerPause"><i class="fa-solid fa-pause"></i> Pause</button>
          <button class="btn btn-outline-primary btn-sm" id="timerReset"><i class="fa-solid fa-rotate-right"></i> Reset</button>
        </div>
        <small class="d-block mt-2" style="opacity:.85;">Tip: Use this for focused Scripture reading and prayer.</small>
      </div>

      <!-- Streak -->
      <div class="card-ui halo tool-card" id="streakCard">
        <h3 class="mb-1"><i class="fa-solid fa-fire"></i> Prayer Streak</h3>
        <p class="mb-2">Mark your daily time with Jesus and keep the fire going.</p>
        <div class="streak-stats">
          <div>Current<br><span class="num" id="streakCurrent">0</span> days</div>
          <div>Longest<br><span class="num" id="streakLongest">0</span> days</div>
        </div>
        <div class="text-center mt-2">
          <button class="btn btn-outline-primary btn-sm" id="markToday"><i class="fa-regular fa-square-check"></i> I Prayed Today</button>
          <button class="btn btn-outline-primary btn-sm" id="undoToday"><i class="fa-regular fa-square"></i> Undo Today</button>
        </div>
        <small class="d-block mt-2 text-center" style="color:var(--muted);">Saved privately on your device.</small>
      </div>

      <!-- Reminder -->
      <div class="card-ui halo tool-card" id="calendarCard">
        <h3 class="mb-1"><i class="fa-regular fa-calendar-check"></i> Daily Reminder</h3>
        <p class="mb-2">Add a 15-minute ‚ÄúDaily Devotional‚Äù reminder to your calendar.</p>
        <div class="text-center">
          <button class="btn btn-outline-primary btn-sm" id="downloadICS"><i class="fa-solid fa-file-arrow-down"></i> Add to Calendar (.ics)</button>
        </div>
        <small class="d-block mt-2 text-center" style="color:var(--muted);">Opens in your calendar app.</small>
      </div>

      <!-- Share -->
      <div class="card-ui halo tool-card" id="shareCard">
        <h3 class="mb-1"><i class="fa-solid fa-share-nodes"></i> Share & Invite</h3>
        <p class="mb-2">Spread the Good News.</p>
        <div class="text-center">
          <button class="btn btn-outline-primary btn-sm" id="shareSite"><i class="fa-solid fa-share-from-square"></i> Share This Site</button>
        </div>
        <small class="d-block mt-2 text-center" style="color:var(--muted);">Web Share when available.</small>
      </div>

      <!-- Quick Verse Lookup (popup) -->
      <div class="card-ui halo tool-card" id="verseLookupCard">
        <h3 class="mb-1"><i class="fa-solid fa-magnifying-glass"></i> Quick Verse Lookup</h3>
        <p class="mb-2">Type a reference (e.g., <strong>John 3:16</strong>) or keywords (e.g., <strong>love enemies</strong>). Opens in a popup.</p>
        <form id="verseLookupForm" class="search-box compact" role="search" aria-label="Quick Verse Lookup">
          <input id="verseLookupInput" type="search" placeholder="e.g., Psalm 23:1-3" aria-label="Verse or keywords">
          <button type="submit"><i class="fa-solid fa-arrow-up-right-from-square"></i> Go</button>
        </form>
        <small class="d-block mt-2 text-center" style="color:var(--muted);">Direct passage when possible; otherwise a search page.</small>
      </div>

      <!-- Bible Story Finder -->
      <div class="card-ui halo tool-card" id="storyPickerCard">
        <h3 class="mb-1"><i class="fa-solid fa-book"></i> Bible Story Finder</h3>
        <p class="mb-2">What Bible story would you like to read?</p>
        <div class="d-flex gap-2 flex-wrap justify-content-center">
          <select id="storySelect" class="form-select form-select-sm" style="max-width:340px;">
            <option value="" selected disabled>Choose a story‚Ä¶</option>
            <option value="Genesis 1-2">Creation (Genesis 1‚Äì2)</option>
            <option value="Genesis 3">The Fall (Genesis 3)</option>
            <option value="Genesis 6-9">Noah‚Äôs Ark (Genesis 6‚Äì9)</option>
            <option value="Genesis 12:1-9">Abraham‚Äôs Call (Genesis 12:1‚Äì9)</option>
            <option value="Genesis 22:1-19">Abraham & Isaac (Genesis 22:1‚Äì19)</option>
            <option value="Genesis 37, Genesis 39-45">Joseph in Egypt (Gen 37; 39‚Äì45)</option>
            <option value="Exodus 3:1-15">Moses & the Burning Bush (Ex 3:1‚Äì15)</option>
            <option value="Exodus 12-14">Passover & Exodus (Ex 12‚Äì14)</option>
            <option value="Exodus 20:1-17">Ten Commandments (Ex 20:1‚Äì17)</option>
            <option value="1 Samuel 17">David & Goliath (1 Sam 17)</option>
            <option value="1 Kings 18:20-46">Elijah vs Baal (1 Kgs 18:20‚Äì46)</option>
            <option value="Daniel 6">Daniel in the Lions‚Äô Den (Dan 6)</option>
            <option value="Jonah 1-4">Jonah and the Great Fish (Jonah 1‚Äì4)</option>
            <option value="Luke 2:1-20">Birth of Jesus (Luke 2:1‚Äì20)</option>
            <option value="Matthew 5-7">Sermon on the Mount (Matt 5‚Äì7)</option>
            <option value="Luke 10:25-37">Good Samaritan (Luke 10:25‚Äì37)</option>
            <option value="Luke 15:11-32">Prodigal Son (Luke 15:11‚Äì32)</option>
            <option value="Matthew 14:22-33">Jesus Walks on Water (Matt 14:22‚Äì33)</option>
            <option value="John 19:16-30">Crucifixion (John 19:16‚Äì30)</option>
            <option value="Luke 24:1-12">Resurrection (Luke 24:1‚Äì12)</option>
            <option value="Matthew 28:16-20">Great Commission (Matt 28:16‚Äì20)</option>
            <option value="Acts 2:1-41">Pentecost (Acts 2:1‚Äì41)</option>
            <option value="Acts 9:1-19">Conversion of Paul (Acts 9:1‚Äì19)</option>
          </select>
          <button class="btn btn-outline-primary btn-sm" id="openStory"><i class="fa-solid fa-book-open"></i> Open</button>
          <button class="btn btn-outline-primary btn-sm" id="randomStory"><i class="fa-solid fa-shuffle"></i> Surprise Me</button>
        </div>
        <small class="d-block mt-2 text-center" style="color:var(--muted);">Shows a scripture passage in a popup (WEB translation).</small>
      </div>
    </div>
  </section>

  <!-- Share QR Modal -->
  <div class="modal fade" id="qrModal" tabindex="-1" aria-labelledby="qrModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" style="background:#0f172a; color:#fff;">
        <div class="modal-header">
          <h5 class="modal-title" id="qrModalLabel"><i class="fa-solid fa-qrcode"></i> Invite via QR</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="qrcode"></div>
          <p class="text-center muted mb-0">Scan to open this page.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Full-Screen Verse Modal -->
  <div class="modal fade" id="verseModal" tabindex="-1" aria-labelledby="verseModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content" style="background:#0f172a; color:#fff;">
        <div class="modal-header">
          <h5 class="modal-title" id="verseModalLabel"><i class="fa-solid fa-book-bible"></i> Daily Verse</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <h3 id="vmRef" style="color:#9fd1ff; font-weight:800; margin-bottom:.5rem;"></h3>
          <p id="vmText" style="font-size:1.15rem; line-height:1.6; margin:0;"></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Lookup Modal (shows text or iframe) -->
  <div class="modal fade" id="lookupModal" tabindex="-1" aria-labelledby="lookupModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen-sm-down modal-xl">
      <div class="modal-content" style="background:#0f172a; color:#fff;">
        <div class="modal-header">
          <h5 class="modal-title" id="lookupModalLabel"><i class="fa-solid fa-book-bible"></i> Passage</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="lookupText" style="display:none;">
            <h4 id="lookupRef" style="color:#9fd1ff; font-weight:800;"></h4>
            <div id="lookupContent" style="white-space:pre-wrap; font-size:1.08rem; line-height:1.65;"></div>
            <small class="d-block mt-2" style="color:#9fbcd6;">Translation: World English Bible (WEB)</small>
          </div>
          <div id="lookupFrameWrap" style="display:none;">
            <iframe id="lookupFrame" title="Passage" style="width:100%;height:70vh;border:0;"></iframe>
            <div id="lookupFallback" class="mt-2 text-center" style="display:none;">
              <a id="lookupOpenExternal" class="btn btn-outline-primary btn-sm" target="_blank" rel="noopener"><i class="fa-solid fa-arrow-up-right-from-square"></i> Open externally</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="section-divider"><hr></div>

  <!-- JOURNAL + Story of the Day -->
  <section id="journal" class="container-narrow">
    <h2 class="section-title">Prayer Journal</h2>
    <p class="section-sub">Write your prayers, reflections, and gratitude to Jesus. Saved locally.</p>

    <!-- Bible Story of the Day -->
    <div class="card-ui halo" id="storyOfDayCard" style="padding:1rem; margin-bottom:1rem;">
      <h3 class="mb-1"><i class="fa-solid fa-sun"></i> Bible Story of the Day</h3>
      <p class="mb-2" id="sodLabel">Loading‚Ä¶</p>
      <div class="text-center">
        <button class="btn btn-outline-primary btn-sm" id="openSOD"><i class="fa-solid fa-book-open"></i> Read Now</button>
        <button class="btn btn-outline-primary btn-sm" id="reloadSOD"><i class="fa-solid fa-rotate"></i> New Story</button>
      </div>
      <small class="d-block mt-2 text-center" style="color:var(--muted);">Scripture-based reference (WEB).</small>
    </div>

    <div class="row g-3">
      <div class="col-12 col-lg-6">
        <div class="card-ui halo journal-wrap" style="padding:1rem; color:#fff; background: radial-gradient(120% 140% at 0% 0%, #0b264c 0%, #0a1b33 60%, #08152a 100%); border:1px solid rgba(255,255,255,.08);">
          <h3 class="mb-2" style="color:#fff;"><i class="fa-solid fa-pen-to-square"></i> New Entry</h3>
          <textarea id="journalText" placeholder="Dear Jesus‚Ä¶"></textarea>
          <div class="journal-actions">
            <button id="saveJournal" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-floppy-disk"></i> Save</button>
            <button id="exportJournal" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-file-arrow-down"></i> Export .txt</button>
            <button id="clearJournal" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-trash"></i> Clear All</button>
          </div>
        </div>
      </div>
      <div class="col-12 col-lg-6">
        <div class="card-ui halo" style="padding:1rem;">
          <h3 class="mb-2"><i class="fa-solid fa-book"></i> Entries</h3>
          <div id="journalList" class="journal-list"></div>
          <small class="muted d-block mt-2 text-center">Only you can see these (stored in this browser).</small>
        </div>
      </div>
    </div>
  </section>

  <div class="section-divider"><hr></div>

  <!-- CONTACT + CHURCH -->
  <section id="connect" class="container-narrow two-up" aria-label="Contact and Church">
    <div class="two-up-grid">
      <section id="contact" class="card-ui halo card-box">
        <h2 class="section-title" style="margin-bottom:.5rem;">Any Concerns or Questions?</h2>
        <div class="qa-actions">
          <a href="https://forms.gle/1PWmQyT5q8ZLvr2M6" target="_blank" rel="noopener" class="qa-link-icon" aria-label="Answer our Questionnaire"><i class="fas fa-clipboard-list"></i></a>
          <a href="https://forms.gle/1PWmQyT5q8ZLvr2M6" target="_blank" rel="noopener" class="btn btn-outline-primary qa-btn">Answer our Questionnaire</a>
        </div>
      </section>

      <section id="church" class="card-ui halo card-box">
        <h2 class="section-title" style="margin-bottom:.5rem;">Why is it IMPORTANT to join a church?</h2>
        <p class="section-sub" style="margin-bottom:.75rem;">We grow best together - Jesus said, <em>‚ÄúFor where two or three are gathered together in my name, there am I in the midst of them.‚Äù</em> ‚Äî <strong>Matthew 18:20</strong>. The enemy loves isolation; fellowship strengthens faith.</p>
        <p class="section-sub" style="margin-bottom:.75rem;"><strong>Why I chose CCF:</strong> CCF was the first Christian church God connected me to. The Lord drew me to know Jesus personally and this church became my home. My denomination is <em>Jesus Christ alone</em>, but CCF has helped me grow through discipleship and community. Their mission is ‚Äúto honor God and make Christ-committed followers who will make Christ-committed followers,‚Äù embodying Matthew 28:18-20. If you‚Äôre looking for a place to start, you can visit their site below.</p>
        <p class="d-flex gap-2 justify-content-center flex-wrap">
          <a href="https://www.ccf.org.ph" target="_blank" rel="noopener" class="btn btn-outline-primary">Visit CCF Website</a>
          <button id="findChurch" class="btn btn-outline-primary"><i class="fa-solid fa-location-dot"></i> Find Church Near Me</button>
        </p>
      </section>
    </div>
  </section>

  <div class="section-divider"><hr></div>

  <!-- REAL-FLECTION -->
  <section id="realflection" style="padding:2rem 1rem; max-width:980px; margin:0 auto;">
    <h2 style="margin-bottom:0.5rem;"><center>‚úù Real-flection for Jesus</center></h2>
    <p style="margin-bottom:1rem;"><center>Share your reflections, prayers, testimonies, or questions for Jesus. You may use an alias or ‚ÄúAnonymous.‚Äù Be loving, respectful, and Christ-centered. Jesus loves you!</center></p>
    <div class="card-ui halo" style="padding:1.25rem; text-align:center;">
      <p style="margin:0 0 .75rem 0;">Tap or click here to share your reflections for Jesus my siblings in Christ.</p>
      <a class="btn btn-outline-primary" href="https://pub21.bravenet.com/forum/1778019806/" target="_blank" rel="noopener"><i class="fa-regular fa-message"></i> Open the Real-flection Board</a>
    </div>
  </section>

  <div class="section-divider"><hr></div>

  <!-- FOOTER -->
  <footer>All rights reserved | Jesus Christ Loves You Forever | John 14:6</footer>

  <!-- BACK TO TOP -->
  <button class="back-to-top" id="backTop" aria-label="Back to top"><i class="fas fa-arrow-up"></i></button>

  <!-- SCRIPTS -->
  <script>
    /* ===== Inline PWA manifest ===== */
    (function initManifest(){
      const manifest = {
        name: "Jesus Loves You",
        short_name: "JLY",
        start_url: ".",
        display: "standalone",
        background_color: "#0b1220",
        theme_color: "#002244",
        icons: [
          { src: "data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><rect width='64' height='64' rx='12' fill='%230b2c5a'/><path d='M30 10h4v16h16v4H34v24h-4V30H14v-4H16z' fill='%23fff'/></svg>", sizes: "any", type: "image/svg+xml" }
        ]
      };
      const blob=new Blob([JSON.stringify(manifest)], {type:'application/json'});
      const url=URL.createObjectURL(blob);
      const link=document.createElement('link');
      link.rel='manifest'; link.href=url; document.head.appendChild(link);
    })();

    /* ===== Theme + Font ===== */
    (function initThemeAndFont(){
      const root = document.documentElement;
      const themeMeta = document.querySelector('meta[name="theme-color"]');
      const applyThemeMeta = () => {
        const isDark = root.getAttribute('data-theme') === 'dark' || (window.matchMedia('(prefers-color-scheme: dark)').matches && !root.getAttribute('data-theme'));
        themeMeta && (themeMeta.setAttribute('content', isDark ? '#0b1220' : '#002244'));
      };
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme) root.setAttribute('data-theme', savedTheme);
      applyThemeMeta();
      document.getElementById('themeToggle')?.addEventListener('click', ()=>{
        const isDark = root.getAttribute('data-theme') === 'dark';
        const next = isDark ? 'light' : 'dark';
        root.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
        applyThemeMeta();
      });

      let fontScale = parseInt(localStorage.getItem('fontScale') || '100', 10);
      function applyScale(){ document.documentElement.style.fontSize = (fontScale/100*16)+'px'; }
      applyScale();
      document.getElementById('fontMinus')?.addEventListener('click', ()=>{ fontScale=Math.max(85,fontScale-5); localStorage.setItem('fontScale',fontScale); applyScale(); });
      document.getElementById('fontPlus')?.addEventListener('click', ()=>{ fontScale=Math.min(130,fontScale+5); localStorage.setItem('fontScale',fontScale); applyScale(); });

      // Keyboard shortcuts
      window.addEventListener('keydown', (e)=>{
        if(e.key==='d' || e.key==='D'){ document.getElementById('themeToggle')?.click(); }
        if(e.key==='+' || e.key==='='){ document.getElementById('fontPlus')?.click(); }
        if(e.key==='-'){ document.getElementById('fontMinus')?.click(); }
      });
    })();

    // Mobile menu toggle
    document.getElementById('menuToggle').addEventListener('click', () => document.getElementById('mainNav').classList.toggle('open'));

    // Enable desktop compact nav + tap-to-expand for touchscreens
    (function initCompactNav(){
      const nav = document.getElementById('mainNav');
      nav.classList.add('compact'); // desktop hover-to-expand
      const hasTouch = ('ontouchstart' in window) || navigator.maxTouchPoints > 0;
      if (hasTouch){
        // Tap anywhere on the nav bar to expand/collapse (desktop tablets)
        nav.addEventListener('click', (e)=>{
          // ignore if clicking a link (smooth-scroll handler will run)
          if (e.target.closest('a')) return;
          nav.classList.toggle('expanded');
        });
        document.addEventListener('click', (e)=>{
          if (!nav.contains(e.target)) nav.classList.remove('expanded');
        });
      }
    })();

    // Smooth scroll with header offset
    document.querySelectorAll('a[href^="#"]').forEach(a => {
      a.addEventListener('click', e => {
        const id = a.getAttribute('href');
        if (id.length > 1) {
          e.preventDefault();
          const el = document.querySelector(id);
          if (!el) return;
          const headerH = document.querySelector('header').offsetHeight;
          const top = el.getBoundingClientRect().top + window.pageYOffset - (headerH + 8);
          window.scrollTo({ top, behavior: 'smooth' });
          const nav = document.getElementById('mainNav');
          if (nav.classList.contains('open')) nav.classList.remove('open');
        }
      });
    });

    // Active nav on scroll
    (function setActiveOnScroll(){
      const links = Array.from(document.querySelectorAll('#mainNav a[href^="#"]'));
      const sections = links.map(a => document.querySelector(a.getAttribute('href'))).filter(Boolean);
      const io = new IntersectionObserver((entries)=>{
        entries.forEach(entry=>{
          const id='#'+entry.target.id;
          const link=links.find(a=>a.getAttribute('href')===id);
          if (!link) return;
          if (entry.isIntersecting) {
            links.forEach(a=>a.removeAttribute('aria-current'));
            link.setAttribute('aria-current','page');
          }
        });
      }, { rootMargin:'-40% 0px -55% 0px', threshold:0 });
      sections.forEach(sec=>io.observe(sec));
    })();

    // Back to top
    const backTop = document.getElementById('backTop');
    window.addEventListener('scroll', () => {
      (window.scrollY > 600) ? backTop.classList.add('show') : backTop.classList.remove('show');
    });
    backTop.addEventListener('click', () => window.scrollTo({ top:0, behavior:'smooth' }));

    // Online/offline banner
    const offlineBanner = document.getElementById('offlineBanner');
    function updateOnline(){ offlineBanner.classList.toggle('show', !navigator.onLine); }
    window.addEventListener('online', updateOnline);
    window.addEventListener('offline', updateOnline);
    updateOnline();

    // Verse fetcher (ESV)
    async function fetchVerse(apiUrl, selectorId) {
      const el = document.getElementById(selectorId);
      try {
        const resp = await fetch(apiUrl, { cache:'no-store' });
        const data = await resp.json();
        const text = data?.verse?.details?.text || '‚Äî';
        const ref  = data?.verse?.details?.reference || '';
        el.querySelector('.verse-text').textContent = text;
        el.querySelector('.cite-ref').textContent  = ref;
      } catch (err) {
        el.querySelector('.verse-text').textContent = 'Could not load verse.';
        el.querySelector('.cite-ref').textContent = '';
      }
    }
    document.addEventListener('DOMContentLoaded', () => {
      fetchVerse("https://beta.ourmanna.com/api/v1/get/?format=json", 'verse-esv');
    });

    // Helpers
    function currentVerse(){
      const el=document.getElementById('verse-esv');
      return {
        text: el?.querySelector('.verse-text')?.textContent?.trim() || '',
        ref:  el?.querySelector('.cite-ref')?.textContent?.trim() || ''
      };
    }

    // Copy
    document.getElementById('btnCopyVerse')?.addEventListener('click', async ()=>{
      const v=currentVerse(); const payload=`${v.text} ‚Äî ${v.ref}`;
      try{ await navigator.clipboard.writeText(payload); alert('Verse copied to clipboard.'); }
      catch{
        const ta=document.createElement('textarea'); ta.value=payload; document.body.appendChild(ta); ta.select();
        document.execCommand('copy'); document.body.removeChild(ta); alert('Verse copied to clipboard.');
      }
    });

    // Share
    document.getElementById('btnShareVerse')?.addEventListener('click', async ()=>{
      const v=currentVerse(); const text=`${v.text} ‚Äî ${v.ref}`;
      if (navigator.share) { try { await navigator.share({ title: v.ref || 'Daily Verse', text }); } catch {} }
      else {
        const url = location.href;
        const tw = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}&url=${encodeURIComponent(url)}`;
        window.open(tw,'_blank','noopener');
      }
    });

    // Read aloud
    document.getElementById('btnSpeakVerse')?.addEventListener('click', ()=>{
      const v=currentVerse(); const u=new SpeechSynthesisUtterance(`${v.text}. ${v.ref}`); u.lang='en-US'; speechSynthesis.cancel(); speechSynthesis.speak(u);
    });

    // Image export
    function wrapCanvasText(ctx, text, x, y, maxWidth, lineHeight){
      const words=text.split(' '); let line='';
      for (let n = 0; n < words.length; n++) {
        const testLine = line + words[n] + ' ';
        const testWidth = ctx.measureText(testLine).width;
        if (testWidth > maxWidth && n > 0) {
          ctx.fillText(line, x, y);
          line = words[n] + ' ';
          y += lineHeight;
        } else {
          line = testLine;
        }
      }
      ctx.fillText(line, x, y);
      return y;
    }
    function drawVerseToCanvas() {
      const { text, ref } = currentVerse();
      const canvas = document.getElementById('verseCanvas');
      const ctx = canvas.getContext('2d');
      const W = canvas.width, H = canvas.height;

      const grad = ctx.createLinearGradient(0, 0, W, H);
      grad.addColorStop(0, '#0b264c'); grad.addColorStop(1, '#08152a');
      ctx.fillStyle = grad; ctx.fillRect(0, 0, W, H);

      ctx.fillStyle = 'rgba(255,255,255,0.06)';
      for (let i=0;i<6;i++){ ctx.beginPath(); ctx.arc(80 + i*180, 120 + (i%2)*60, 60, 0, Math.PI*2); ctx.fill(); }

      ctx.fillStyle = '#9fd1ff'; ctx.font = 'bold 36px Inter, system-ui, sans-serif'; ctx.fillText('Daily Bible Verse', 60, 80);

      ctx.fillStyle = '#ffffff'; ctx.font = 'bold 44px Inter, system-ui, sans-serif'; ctx.textBaseline = 'top'; ctx.shadowColor = 'rgba(0,0,0,0.25)'; ctx.shadowBlur = 4;
      const maxWidth = W - 120; let y = 140; const trySizes = [44, 40, 36, 32, 28];
      for (const size of trySizes){
        ctx.font = `bold ${size}px Inter, system-ui, sans-serif`;
        const measure = ctx.measureText(text);
        if (size === trySizes[trySizes.length-1] || measure.width / maxWidth < 3.5) {
          y = wrapCanvasText(ctx, text, 60, y, maxWidth, size * 1.35) + 24; break;
        }
      }
      ctx.shadowBlur = 0; ctx.fillStyle = '#9fd1ff'; ctx.font = 'bold 32px Inter, system-ui, sans-serif'; ctx.fillText(ref || '', 60, y);

      ctx.fillStyle = 'rgba(255,255,255,0.85)'; ctx.font = '600 20px Inter, system-ui, sans-serif';
      const footer = 'jesuslovesyousomuch.github.io/Jesus-is-the-only-way'; ctx.fillText(footer, 60, H - 60);
    }
    document.getElementById('btnImageVerse')?.addEventListener('click', () => {
      drawVerseToCanvas();
      const canvas = document.getElementById('verseCanvas');
      const link = document.createElement('a');
      const safeRef = (currentVerse().ref || 'verse').replace(/[^a-z0-9\-_. ]/gi,'_').slice(0,60);
      link.download = `${safeRef}.png`; link.href = canvas.toDataURL('image/png'); link.click();
    });

    /* ===== Lookup & Story popup logic ===== */
    function parseBibleRef(input){
      const refRe = /^\s*([1-3]?\s?[A-Za-z\.]+)\s+(\d+)(?::(\d+(?:-\d+)?))?\s*$/;
      const m = input.match(refRe); if (!m) return null;
      const book = m[1].replace(/\s+/g,' ').trim(); const chap  = m[2]; const verse = m[3] || '';
      return { book, chap, verse };
    }

    function showLookupText(ref, text){
      document.getElementById('lookupText').style.display = '';
      document.getElementById('lookupFrameWrap').style.display = 'none';
      document.getElementById('lookupRef').textContent = ref;
      document.getElementById('lookupContent').textContent = text.trim();
      new bootstrap.Modal(document.getElementById('lookupModal')).show();
    }
    function showLookupIframe(url){
      const wrap = document.getElementById('lookupFrameWrap');
      const frame = document.getElementById('lookupFrame');
      const fb = document.getElementById('lookupFallback');
      const ext = document.getElementById('lookupOpenExternal');
      document.getElementById('lookupText').style.display = 'none';
      wrap.style.display = ''; fb.style.display = 'none'; frame.src = url; ext.href = url;
      new bootstrap.Modal(document.getElementById('lookupModal')).show();
      // if embedding is blocked, show fallback link
      setTimeout(()=>{ try{ void frame.contentWindow.document.title; } catch(e){ fb.style.display=''; } }, 1200);
    }

    async function openPassageTextModal(ref){
      // Use bible-api.com (public domain WEB translation)
      const url = `https://bible-api.com/${encodeURIComponent(ref)}?translation=web`;
      try{
        const r = await fetch(url, {cache:'no-store'}); const j = await r.json();
        const verses = (j.verses || []).map(v => `${v.text.trim()} (${v.book_name} ${v.chapter}:${v.verse})`).join('\n');
        const text = j.text ? j.text : verses || 'Passage not found.';
        const reference = j.reference || ref;
        showLookupText(reference, text);
      }catch{
        // fallback to search page in iframe
        showLookupIframe(`https://www.biblegateway.com/passage/?search=${encodeURIComponent(ref)}&version=ESV`);
      }
    }

    function openKeywordModal(query){
      const url = `https://www.biblegateway.com/quicksearch/?quicksearch=${encodeURIComponent(query)}&version=ESV`;
      showLookupIframe(url);
    }

    function openLookup(query){
      const ref = parseBibleRef(query);
      if (ref){
        const refString = `${ref.book} ${ref.chap}${ref.verse ? ':'+ref.verse : ''}`;
        openPassageTextModal(refString);
      } else {
        openKeywordModal(query);
      }
    }

    // Quick lookup submit
    document.getElementById('verseLookupForm')?.addEventListener('submit', (e)=>{
      e.preventDefault();
      const q = (document.getElementById('verseLookupInput').value || '').trim();
      if (!q) return; openLookup(q);
    });

    // Daily verse "Open"
    document.getElementById('btnOpenVerse')?.addEventListener('click', ()=>{
      const v=currentVerse();
      if (v.ref){ openPassageTextModal(v.ref); }
      else { openKeywordModal('verse of the day ESV'); }
    });

    // Full-screen verse
    document.getElementById('btnFullVerse')?.addEventListener('click', ()=>{
      const v=currentVerse();
      document.getElementById('vmRef').textContent = v.ref || '';
      document.getElementById('vmText').textContent = v.text || '';
      try{ new bootstrap.Modal(document.getElementById('verseModal')).show(); }catch{ alert(`${v.ref}\n\n${v.text}`); }
    });

    // Story Finder wiring
    const STORY_REFS = [
      {label:'Creation (Genesis 1‚Äì2)', ref:'Genesis 1-2'},
      {label:'The Fall (Genesis 3)', ref:'Genesis 3'},
      {label:'Noah‚Äôs Ark (Genesis 6‚Äì9)', ref:'Genesis 6-9'},
      {label:'Abraham‚Äôs Call (Genesis 12:1‚Äì9)', ref:'Genesis 12:1-9'},
      {label:'Abraham & Isaac (Genesis 22:1‚Äì19)', ref:'Genesis 22:1-19'},
      {label:'Joseph in Egypt (Gen 37; 39‚Äì45)', ref:'Genesis 37, Genesis 39-45'},
      {label:'Moses & the Burning Bush (Ex 3:1‚Äì15)', ref:'Exodus 3:1-15'},
      {label:'Passover & Exodus (Ex 12‚Äì14)', ref:'Exodus 12-14'},
      {label:'Ten Commandments (Ex 20:1‚Äì17)', ref:'Exodus 20:1-17'},
      {label:'David & Goliath (1 Sam 17)', ref:'1 Samuel 17'},
      {label:'Elijah vs Baal (1 Kgs 18:20‚Äì46)', ref:'1 Kings 18:20-46'},
      {label:'Daniel in the Lions‚Äô Den (Dan 6)', ref:'Daniel 6'},
      {label:'Jonah and the Great Fish (Jonah 1‚Äì4)', ref:'Jonah 1-4'},
      {label:'Birth of Jesus (Luke 2:1‚Äì20)', ref:'Luke 2:1-20'},
      {label:'Sermon on the Mount (Matt 5‚Äì7)', ref:'Matthew 5-7'},
      {label:'Good Samaritan (Luke 10:25‚Äì37)', ref:'Luke 10:25-37'},
      {label:'Prodigal Son (Luke 15:11‚Äì32)', ref:'Luke 15:11-32'},
      {label:'Jesus Walks on Water (Matt 14:22‚Äì33)', ref:'Matthew 14:22-33'},
      {label:'Crucifixion (John 19:16‚Äì30)', ref:'John 19:16-30'},
      {label:'Resurrection (Luke 24:1‚Äì12)', ref:'Luke 24:1-12'},
      {label:'Great Commission (Matt 28:16‚Äì20)', ref:'Matthew 28:16-20'},
      {label:'Pentecost (Acts 2:1‚Äì41)', ref:'Acts 2:1-41'},
      {label:'Conversion of Paul (Acts 9:1‚Äì19)', ref:'Acts 9:1-19'},
    ];
    document.getElementById('openStory')?.addEventListener('click', ()=>{
      const sel = document.getElementById('storySelect'); if (sel.value) openPassageTextModal(sel.value);
    });
    document.getElementById('randomStory')?.addEventListener('click', ()=>{
      const pick = STORY_REFS[Math.floor(Math.random()*STORY_REFS.length)];
      document.getElementById('storySelect').value = pick.ref; openPassageTextModal(pick.ref);
    });

    // Story of the Day (deterministic by date)
    function pickDailyStory(){
      const d = new Date(); const ymd = Number(d.toISOString().slice(0,10).replace(/-/g,'')); return STORY_REFS[ymd % STORY_REFS.length];
    }
    function renderSOD(story){
      document.getElementById('sodLabel').textContent = story.label;
      document.getElementById('openSOD').onclick = ()=> openPassageTextModal(story.ref);
    }
    document.addEventListener('DOMContentLoaded', ()=>{ renderSOD(pickDailyStory()); });
    document.getElementById('reloadSOD')?.addEventListener('click', ()=>{
      const s = STORY_REFS[Math.floor(Math.random()*STORY_REFS.length)]; renderSOD(s);
    });

    /* ===== Prayer Streak ===== */
    const STREAK_KEY = 'jly:streakDates';
    function todayKey(){ const d=new Date(); return d.toISOString().slice(0,10); }
    function calcStreak(dates){
      const set = new Set(dates); let curr = 0; let day = new Date();
      for(;;){ const key = day.toISOString().slice(0,10); if (set.has(key)){ curr++; day.setDate(day.getDate()-1); } else break; }
      const sorted = [...dates].sort(); let longest = 0, run = 0, prev = null;
      for(const k of sorted){ if (!prev){ run=1; } else { const d1 = new Date(prev), d2 = new Date(k); const diff = (d2 - d1) / 86400000; run = (diff === 1) ? run + 1 : 1; } longest = Math.max(longest, run); prev = k; }
      return { curr, longest };
    }
    function renderStreak(){
      const dates = JSON.parse(localStorage.getItem(STREAK_KEY) || '[]');
      const { curr, longest } = calcStreak(dates);
      document.getElementById('streakCurrent').textContent = curr;
      document.getElementById('streakLongest').textContent = longest;
    }
    renderStreak();
    document.getElementById('markToday')?.addEventListener('click', ()=>{
      const dates = JSON.parse(localStorage.getItem(STREAK_KEY) || '[]'); const t = todayKey();
      if (!dates.includes(t)){ dates.push(t); localStorage.setItem(STREAK_KEY, JSON.stringify(dates)); renderStreak(); }
    });
    document.getElementById('undoToday')?.addEventListener('click', ()=>{
      const dates = JSON.parse(localStorage.getItem(STREAK_KEY) || '[]'); const t = todayKey(); const idx = dates.indexOf(t);
      if (idx>-1){ dates.splice(idx,1); localStorage.setItem(STREAK_KEY, JSON.stringify(dates)); renderStreak(); }
    });

    /* ===== Calendar (.ics) ===== */
    function pad(n){ return n.toString().padStart(2,'0'); }
    function nextStartAt(hourLocal){ const d = new Date(); d.setMinutes(0,0,0); if (d.getHours() >= hourLocal) d.setDate(d.getDate()+1); d.setHours(hourLocal); return d; }
    document.getElementById('downloadICS')?.addEventListener('click', ()=>{
      const start = nextStartAt(7);
      const dt = `${start.getFullYear()}${pad(start.getMonth()+1)}${pad(start.getDate())}T${pad(start.getHours())}${pad(start.getMinutes())}00`;
      const uid = `${Date.now()}@jly`;
      const ics = [
        'BEGIN:VCALENDAR','VERSION:2.0','PRODID:-//JLY//Devotional Reminder//EN',
        'BEGIN:VEVENT',`UID:${uid}`,`DTSTAMP:${dt}`,`DTSTART:${dt}`,
        'DURATION:PT15M','RRULE:FREQ=DAILY','SUMMARY:Daily Devotional',
        'DESCRIPTION:Set aside 15 minutes for Scripture, prayer, and reflection.','END:VEVENT','END:VCALENDAR'
      ].join('\r\n');
      const blob = new Blob([ics], {type:'text/calendar;charset=utf-8'});
      const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = 'daily-devotional.ics'; a.click(); URL.revokeObjectURL(url);
    });

    /* ===== Share & QR ===== */
    document.getElementById('shareSite')?.addEventListener('click', async ()=>{
      const url = location.href; const title = 'Jesus Loves You'; const text  = 'Be encouraged. Read the daily Bible verse here.';
      if (navigator.share){ try{ await navigator.share({ title, text, url }); } catch {} }
      else { try{ await navigator.clipboard.writeText(url); alert('Link copied to clipboard.'); }
      catch{ open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(text)}`,'_blank','noopener'); } }
    });

    document.getElementById('openQR')?.addEventListener('click', ()=>{
      const url = location.href; const img = document.createElement('img'); img.alt = 'QR code'; img.width = 240; img.height = 240;
      img.src = `https://api.qrserver.com/v1/create-qr-code/?size=240x240&data=${encodeURIComponent(url)}`;
      const box = document.getElementById('qrcode'); box.innerHTML = ''; box.appendChild(img);
      try{ new bootstrap.Modal(document.getElementById('qrModal')).show(); } catch { alert('QR code ready. If the modal did not open, please allow popups.'); }
    });

    // Find church near me
    document.getElementById('findChurch')?.addEventListener('click', ()=>{
      if (navigator.geolocation){
        navigator.geolocation.getCurrentPosition(
          pos => { const { latitude, longitude } = pos.coords; const url = `https://www.google.com/maps/search/church/@${latitude},${longitude},14z`; window.open(url, '_blank', 'noopener'); },
          () => window.open('https://www.google.com/maps/search/church+near+me', '_blank', 'noopener'),
          { timeout: 6000 }
        );
      } else { window.open('https://www.google.com/maps/search/church+near+me', '_blank', 'noopener'); }
    });

    /* ===== Journal ===== */
    const J_KEY = 'jly:journal';
    function renderJournal(){
      const list = document.getElementById('journalList');
      if (!list) return;
      const items = JSON.parse(localStorage.getItem(J_KEY) || '[]');
      if (!items.length){ list.innerHTML = `<p class="muted">No entries yet.</p>`; return; }
      list.innerHTML = items.slice().reverse().map((it) => `
        <div class="mb-2 p-2" style="border:1px dashed rgba(255,255,255,.2); border-radius:8px;">
          <div style="font-weight:800">${new Date(it.at).toLocaleString()}</div>
          <div style="white-space:pre-wrap">${(it.text||'').replace(/[<>&]/g,c=>({'<':'&lt;','>':'&gt;','&':'&amp;'}[c]))}</div>
        </div>
      `).join('');
    }
    renderJournal();
    document.getElementById('saveJournal')?.addEventListener('click', ()=>{
      const ta = document.getElementById('journalText'); const text = (ta.value || '').trim(); if (!text) return;
      const items = JSON.parse(localStorage.getItem(J_KEY) || '[]'); items.push({ text, at: Date.now() });
      localStorage.setItem(J_KEY, JSON.stringify(items)); ta.value=''; renderJournal();
    });
    document.getElementById('exportJournal')?.addEventListener('click', ()=>{
      const items = JSON.parse(localStorage.getItem(J_KEY) || '[]');
      const txt = items.map(i => `[${new Date(i.at).toLocaleString()}]\n${i.text}\n\n`).join('') || 'No entries yet.';
      const blob = new Blob([txt], {type:'text/plain'}); const url  = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'journal.txt'; a.click(); URL.revokeObjectURL(url);
    });
    document.getElementById('clearJournal')?.addEventListener('click', ()=>{
      if (confirm('Delete ALL journal entries? This cannot be undone.')){ localStorage.setItem(J_KEY, JSON.stringify([])); renderJournal(); }
    });

    /* ===== Devotional Timer (fixed) ===== */
    (function initTimer(){
      const display = document.getElementById('timerDisplay');
      const startBtn = document.getElementById('timerStart');
      const pauseBtn = document.getElementById('timerPause');
      const resetBtn = document.getElementById('timerReset');
      const pills = Array.from(document.querySelectorAll('#timerCard .timer-pills button'));

      const state = { base: 15*60, remaining: 15*60, running:false, endAt:null, id:null };

      function fmt(sec){
        sec = Math.max(0, Math.ceil(sec));
        const m = Math.floor(sec/60), s = sec%60;
        return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
      }
      function render(){ display.textContent = fmt(state.remaining); }

      function setBase(min){
        state.base = min*60;
        state.remaining = state.base;
        state.endAt = null;
        if (state.id){ clearInterval(state.id); state.id=null; }
        state.running=false;
        pills.forEach(b=>b.classList.toggle('active', Number(b.dataset.min)===min));
        render();
      }

      function tick(){
        if (!state.running) return;
        state.remaining = Math.max(0, Math.ceil((state.endAt - Date.now())/1000));
        render();
        if (state.remaining <= 0){
          stop();
          chime();
        }
      }

      function start(){
        if (state.running) return;
        state.running = true;
        state.endAt = Date.now() + state.remaining*1000;
        state.id = setInterval(tick, 250);
        tick();
      }
      function pause(){
        if (!state.running) return;
        state.running = false;
        if (state.id){ clearInterval(state.id); state.id=null; }
        // keep remaining as-is
      }
      function stop(){ pause(); state.remaining = 0; render(); }
      function reset(){ pause(); state.remaining = state.base; render(); }

      function chime(){
        // gentle beep + vibration
        try{
          const ctx = new (window.AudioContext||window.webkitAudioContext)();
          const beep = (f, t) => {
            const o = ctx.createOscillator(); const g = ctx.createGain();
            o.type='sine'; o.frequency.value=f; o.connect(g); g.connect(ctx.destination);
            g.gain.setValueAtTime(0.0001, ctx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.25, ctx.currentTime+0.02);
            o.start(); o.stop(ctx.currentTime + t);
          };
          beep(880, 0.15); setTimeout(()=>beep(660,0.2), 180);
          setTimeout(()=>ctx.close(), 800);
        }catch{}
        if (navigator.vibrate) navigator.vibrate([150,80,150]);
        try { document.title = '‚è± Done! ‚Äî Jesus Loves You'; setTimeout(()=>{ document.title='Jesus Loves You'; }, 4000);} catch{}
      }

      // events
      pills.forEach(b=>b.addEventListener('click', ()=>{
        setBase(Number(b.dataset.min));
      }));
      startBtn.addEventListener('click', start);
      pauseBtn.addEventListener('click', pause);
      resetBtn.addEventListener('click', reset);

      // init
      setBase(15);
    })();

    /* ===== PWA SW ===== */
    (function registerSW(){
      if (!('serviceWorker' in navigator)) return;
      const sw = `
self.addEventListener('install', event => {
  event.waitUntil(caches.open('jly-v1').then(c => c.addAll(['./'])));
});
self.addEventListener('fetch', event => {
  event.respondWith(fetch(event.request).catch(() => caches.match(event.request).then(r => r || caches.match('./'))));
});
      `.trim();
      const blob = new Blob([sw], {type:'text/javascript'}); const url  = URL.createObjectURL(blob);
      navigator.serviceWorker.register(url).catch(()=>{});
    })();
  </script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>
</body>
</html>
